% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/NESS.R
\name{NESS}
\alias{NESS}
\title{NESS: Neighbor Embedding Stability Scoring}
\usage{
NESS(
  data,
  ...,
  data.name = "",
  GCP = NULL,
  cluster = NULL,
  rareness = FALSE,
  method = "tsne",
  initialization = 1,
  stability_threshold = 0.75,
  early_stop = TRUE,
  seed_base = 1,
  N = 20,
  k = 50,
  svd_cutoff_ratio = 1.1,
  svd_max_k = 30,
  stop_global_stability_threshold = 0.9,
  stop_relative_change_threshold = 0.05
)
}
\arguments{
\item{data}{A numeric matrix or data frame with rows as observations and columns as features.}

\item{...}{Additional arguments passed to the dimensionality reduction methods
(\code{Rtsne}, \code{uwot::umap}, or \code{phateR::phate}), such as \code{theta} for t-SNE,
\code{min_dist} for UMAP, or \code{decay} for PHATE.}

\item{data.name}{Character string used in plot titles to label the dataset.}

\item{GCP}{Optional numeric vector of neighborhood sizes (e.g., perplexity for t-SNE or
number of neighbors for UMAP/PHATE). If \code{NULL}, a default sequence is generated.}

\item{cluster}{Optional vector of cluster labels for coloring the embedding plots.}

\item{rareness}{Logical; if \code{TRUE}, computes rareness metrics based on neighbor consistency across embeddings.}

\item{method}{Dimensionality reduction method to use. One of \code{"tsne"}, \code{"umap"}, or \code{"phateR"}.}

\item{initialization}{Initialization method: \code{1} for random, \code{2} for PCA-based initialization.}

\item{stability_threshold}{Quantile threshold (default = 0.75) for determining local neighbor stability.}

\item{early_stop}{Logical; if \code{TRUE}, stops early if global stability saturates.}

\item{seed_base}{Base random seed used for reproducibility.}

\item{N}{Number of repeated embedding runs.}

\item{k}{Number of nearest neighbors to use when computing stability metrics (default = 50).}

\item{svd_cutoff_ratio}{Threshold ratio used to estimate intrinsic dimensionality via SVD (default = 1.1).}

\item{svd_max_k}{Maximum number of SVD components to check when estimating dimensionality (default = 30).}

\item{stop_global_stability_threshold}{Early stopping threshold for global stability (default = 0.9).}

\item{stop_relative_change_threshold}{Early stopping threshold for relative improvement in global stability (default = 0.05).}
}
\value{
A list containing:
\describe{
\item{GCP}{Vector of neighborhood sizes used for evaluation.}
\item{GCP.optim}{The selected GCP value corresponding to the median rareness score.}
\item{rare.mean}{(optional) Vector of rareness mean scores across GCP values (if \code{rareness = TRUE}).}
\item{rare.var}{(optional) Vector of rareness variance scores across GCP values (if \code{rareness = TRUE}).}
\item{embedding}{Embedding coordinates for the optimal GCP value.}
\item{local_stability}{Vector of local kNN stability scores (no names).}
\item{global_stability}{Vector of global stability scores across GCP values.}
\item{embedding_stability_colored}{A ggplot2 plot of the embedding colored by local stability score.}
\item{global_stability_plot}{A ggplot2 line plot showing global stability across GCP values.}
\item{embedding_cluster_colored}{(optional) Embedding plot colored by cluster labels, if \code{cluster} is provided.}
\item{rareness_mean}{(optional) ggplot2 plot of rareness score mean, if \code{rareness = TRUE}.},
\item{par}{A list of input parameters used to run the function for reproducibility.}
}
}
\description{
Performs dimensionality reduction (t-SNE, UMAP, or PHATE) multiple times to evaluate
local neighbor stability across repeated embeddings. This function helps assess
the robustness of low-dimensional embeddings for high-dimensional data.
}
