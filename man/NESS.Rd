% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/NESS.R
\name{NESS}
\alias{NESS}
\title{NESS: Neighbor Embedding Stability Scoring}
\usage{
NESS(
  GCP = NULL,
  data,
  cell_type = NULL,
  rareness = FALSE,
  data.name,
  method = "tsne",
  initialization = 1,
  stability_threshold = 0.75,
  early_stop = TRUE
)
}
\arguments{
\item{GCP}{Optional numeric vector of neighborhood sizes (e.g., perplexity for t-SNE).
If \code{NULL}, the function generates a default sequence.}

\item{data}{A numeric matrix or data frame with rows as observations and columns as features.}

\item{cell_type}{Optional vector of cell type labels for coloring the embedding plots.}

\item{rareness}{Logical; if \code{TRUE}, computes rareness metrics based on neighbor stability.}

\item{data.name}{Character string used in plot titles to label the dataset.}

\item{method}{Dimensionality reduction method to use. One of \code{"tsne"}, \code{"umap"}, or \code{"phateR"}.}

\item{initialization}{Initialization method: \code{1} for random, \code{2} for PCA.}

\item{stability_threshold}{Quantile threshold (default = 0.75) for determining neighbor stability.}

\item{early_stop}{Logical; if \code{TRUE}, stops early if global stability saturates.}
}
\value{
A list containing:
\describe{
\item{local_stability}{A list of local kNN stability scores across GCP values.}
\item{plot_list_stability}{A list of ggplot2 objects showing embeddings colored by stability.}
\item{global_stability_plot}{A ggplot2 plot showing global stability vs. GCP.}
\item{plot_list_cell_type}{(optional) Embedding plots colored by cell type.}
\item{rareness_mean}{(optional) A plot of the rareness score (mean) if \code{rareness = TRUE}.}
}
}
\description{
Performs dimensionality reduction (t-SNE, UMAP, or PHATE) multiple times to evaluate
local neighbor stability across repeated embeddings. This function is useful for
evaluating the robustness of low-dimensional embeddings for high-dimensional data.
}
